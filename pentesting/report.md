## Personal Attacks

### Ian Robertson
| Item           | Result                                                                         |
| -------------- | ------------------------------------------------------------------------------ |
| Date           | April 10, 2025                                                                 |
| Target         | pizza.ianjrobertson.click                                                      |
| Classification | Injection                                                                      |
| Severity       | 1                                                                              |
| Description    | SQL injection possible through the updateUser endpoint and the password field  |
| Images         | ![sql](sql_injection.png)                                                      |
| Corrections    | Sanitize user inputs.                                                          |

| Item           | Result                                                                         |
| -------------- | ------------------------------------------------------------------------------ |
| Date           | April 12, 2025                                                                 |
| Target         | pizza.ianjrobertson.click                                                      |
| Classification | Broken Access Control                                                          |
| Severity       | 3                                                                              |
| Description    | Sign in using the admin jwt pizza account, then you can call updateUser and lock the admin out of the system, then the only way to create another admin is to reset the database                 |
| Images         | ![sql](admin_lockout.png)                                                      |
| Corrections    | Just delete the updateUser endpoint. It is never called anywhere else          |

| Item           | Result                                                                         |
| -------------- | ------------------------------------------------------------------------------ |
| Date           | April 12, 2025                                                                 |
| Target         | pizza.ianjrobertson.click                                                      |
| Classification | Broken Access Control                                                          |
| Severity       | 3                                                                              |
| Description    |Register a user, update your email to be the email of a known user (a@jwt.com, franchisee@jwt.com, diner@jwt.com). Then change your email back. Will corrupt the email for other users.                  |
| Images         | ![sql](update_user.png)                                                        |
| Corrections    | Just delete the updateUser endpoint. It is never called anywhere else          |


## Peer Attack

### Ian attacking Evan
#### SQL Injection attack
For my attack, I first tried to perform my SQL injection attacks using the update user endpoint. None of my attacks worked. I tried to drop the user, franchise, menu tables. But my attacks only renamed the emails to be things like `fake@jwt.com'; DROP TABLE user; -- `. I expected this exploit to work, but Evan had found it and patched the issue by using SQL parameterization on the query. 

> Code I was trying to exploit
```javascript
if (email) {
    params.push(`email='${email}'`);
}
```

> Evans secure code
```javascript
if (email) {
    params.push(`email=?`);
    values.push(email);
}
```

#### Broken Access Control attack
For this attack, I tried to corrupt and log out users by changing the email address of a known user to to a created user. I thought this exploit was working on my system, but it was likely just a side effect of the previous test. The emails I thought I was changing like `d@jwt.com` probably didn't exist in the database because I had already changed them to `d@jwt.com'; DROP TABLE user; --`, the the email was available in the table. 

Overall it was an unsuccessful (or very successful) penetration test. 
